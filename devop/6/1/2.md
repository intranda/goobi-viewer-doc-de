# 6.1.2 Inhalte der Dateien

## **Template-Datei**

Die Template-Datei ist eine XML-Datei, die alle Meta-Informationen zu dem Template beinhaltet, außerdem eine Liste der möglichen benutzerdefinierten Inhalte. Diese Inhalte werden in der Layout-Datei referenziert, teilweise auch in Layout-Dateien anderer Templates, die dieses Template als Teil einer Liste enthalten.

![](../../../.gitbook/assets/devop\_6.1.2\_1.png)

Die Template-Datei hat dabei stets einen beispielhaften Aufbau:

```markup
<cms_page_template id="example_template" version="2015-02-03">
     <name>Beispiel Template</name>
     <description>Dies ist eine Beschreibung des Templates.</description>
     <icon>cms_template_example.png</icon>
     <html>cms_template_example.xhtml</html>
     <content>
            <item id="A1" label="Überschrift" type="TEXT" mandatory="true" />
            <item id="A2" label="Text" type="HTML" mandatory="true" />
            <item id="image01" label="Bild" type="MEDIA" />
            <item id="queryList01" label="Werke" type="SOLRQUERY" />
            <item id="pageList01" label="News-Einträge" type="PAGELIST" />
            <item id="document" label="Dokument" type="MEDIA" filter=".*(.docx|.rtf|.htm|.html|.xhtml)" />
     </content>
</cms_page_template>
```

Die einzelnen Elemente im Überblick:

| Option                          | Beschreibung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **cms\_page\_template/id**      | Ein einzigartiger Identifier-String des Templates, der intern zur Identifikation des Templates verwendet wird                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **cms\_page\_template/version** | Das Datum der letzten Änderung. Wird vom Goobi viewer Core nicht verwendet sondern dient dem internen Tracking von Änderungen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **name**                        | Der Name des Templates. Dieser wird beim Erstellen neuer Seiten in der Oberfläche angezeigt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **description**                 | Eine Beschreibung des Templates. Diese wird beim Erstellen neuer Seiten in der Oberfläche angezeigt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **icon**                        | Der Dateiname des Icons, das dieses Template beim Erstellen neuer Seiten und beim Bearbeiten vorhandener Seiten repräsentiert; ohne Pfadangabe.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **html**                        | Der Dateiname der Layout-Datei für dieses Template; ohne Pfadangabe.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **content**                     | <p>Eine Liste von <code>&#x3C;item></code>-Elementen. Jedes dieser Elemente bekommt einen eigenen Editorbereich beim Anlegen/Bearbeiten von CMS-Seiten auf Basis dieses Templates. Die Art des Editorbereichs hängt ab von der Art des Items. Jedes Item hat folgende Attribute:</p><ul><li><strong>id:</strong> Ein für dieses Template einzigartiger Identifier-String, mit dem dieser Inhalt in der Layout-Datei referenziert wird.</li><li><strong>label</strong>: Die Bezeichnung dieses Inhaltes im Editorbereich der Seitenbearbeitung.</li><li><strong>order</strong>: Bestimmt die Reihenfolge in der der Anzeige. Muss Zahlen enthalten. Ist das Attribut nicht gesetzt wird nach der ID sortiert.</li><li><strong>type</strong>: Der Inhaltstyp, siehe <a href="3.md">Kapitel 6.4.3</a>.</li><li><strong>mandatory</strong>: Optionales. Wenn gesetzt und der Wert <code>"true"</code> dann ist das Feld ein Pflichtfeld.</li><li><strong>filter</strong>: Optional. Regulärer Ausdruck (regex), um die Medienauswahl auf bestimmte Dateiendungen zu beschränken.</li><li><p><strong>mode</strong>: Optional. Schaltet bei bestimmten Inhaltstypen besondere Optionen bei der Seitenerstellung für dieses Item frei. Folgende Modi sind implementiert:</p><ul><li><strong>simple</strong>: Kein besonderes Verhalten. Default-Wert</li><li><strong>expanded</strong>: Nur für Inhaltstyp <code>COLLECTION</code>. Erlaubt erweiterte Einstellungen zur Darstellung der Sammlungsanzeige.</li><li><strong>paginated</strong>: Nur für Inhaltstyp <code>PAGELILST</code>. Erlaubt eine Paginierung der Seitenliste.</li></ul></li></ul> |

## **Layout-Datei**

Die Layout-Datei ist eine XHTML-Datei die das Layout mit JSF beschreibt. Sie ist wie eine übliche Goobi viewer Core Seite aufgebaut, benötigt jedoch für die Anzeige von CMS-Inhalten einige spezielle Annotationen. So muss am Anfang der Seite vor etwaigen CMS-Inhalten die folgende Zeile zwingend existieren:

```markup
<ui:param name="cmsPage" value="#{cmsBean.currentPage}" />
```

Dies setzt den Parameter `page`, aus dem alle CMS-Inhalte ausgelesen werden. Um einen beliebigen in der Template-Datei definierten Inhalt einzufügen, verwendet man die folgende Notation:

```
"#{cmsPage.getContent('content01')}"
```

Dabei stellt `content01` die `id` eines in der Template-Datei definierten Inhaltstyps dar. Der Inhalt wird automatisch je nach Typ eingefügt.

Die Sidebar der Seite muss im Tag `<ui:define name=“sidebar“/>` definiert werden. Zur Verwendung benutzderdefinierter Sidebars muss sie folgende Form haben:

```markup
<ui:define name="sidebar">
      <c:forEach var="element" items="#{cmsBean.getSidebarElements(true)}">
            <widgetComponent:widget_bookshelves widget="#{element}"/>
            <widgetComponent:widget_browsing widget="#{element}"/>
            <widgetComponent:widget_crowdsourcing widget="#{element}"/>
            <widgetComponent:widget_mySearches widget="#{element}"/>
            <widgetComponent:widget_searchField widget="#{element}"/>
            <widgetComponent:widget_user widget="#{element}"/>
            <widgetComponent:widget_custom widget="#{element}"/>
      </c:forEach>
</ui:define>
```

Jedes möglicherweise vorkommende Sidebar-Widget muss in der Liste als `<widgetComponent>` enthalten sein; der Name des Widgets muss dabei dem Dateinamen der Widget-Komponente entsprechen. Beispielsweise ruft `<widgetComponent:widget_user>` das in der Datei `/components/widget_user.xhtml` definierte Widget auf.

![](../../../.gitbook/assets/devop\_6.1.2\_2.png)

## **Template-Icon**

Hierbei handelt es sich um eine einfache Bilddatei zur Repräsentation des Templates. Das Bild muss quadratische Abmessungen haben. Üblicherweise werden 128x128px große PNG-Dateien verwendet.
