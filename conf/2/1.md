# 2.1 Hauptkonfiguration

Die Hauptkonfiguration sieht standardmäßig wie folgt aus:

{% tabs %}
{% tab title="config_indexer.xml" %}
```markup
<init>
    <sleep>1000</sleep>
    <minStorageSpace>2048</minStorageSpace>
    <solrUrl>http://localhost:8983/solr/collection1</solrUrl>
    <!-- <oldSolrUrl>http://localhost:8080/solr/collection1</oldSolrUrl> -->
    <viewerUrl>http://localhost:808/viewer/</viewerUrl>
    <viewerAuthorizationToken>CHANGEME</viewerAuthorizationToken>
    <deleteContentFilesOnFailure>true</deleteContentFilesOnFailure>
    <addVolumeCollectionsToAnchor>false</addVolumeCollectionsToAnchor>
    <representativeImage>
        <useFirstPageAsDefault>true</useFirstPageAsDefault>
    </representativeImage>
    <namespaces>
        <!--
        <list>
            <xyz>http://www.example.org/xyz/</xyz>
        </list>
        -->
    </namespaces>    
    <pageCountStart>1</pageCountStart>
    <addLabelToChildren>true</addLabelToChildren>
    <labelCleanup>true</labelCleanup>
    <authorityData enabled="true">
        <addFieldsToDefault>
            <field>NORM_IDENTIFIER</field>
            <field>NORM_NAME</field>
            <field>NORM_ALTNAME</field>
        </addFieldsToDefault>
    </authorityData>
    <aggregateRecords>true</aggregateRecords>
    <fulltextForceUTF8>true</fulltextForceUTF8>
    <mets>
        <preferredImageFileGroup>BOOKVIEWER</preferredImageFileGroup>
        <preferredImageFileGroup>ZOOMIFY</preferredImageFileGroup>
        <physicalElementTypes>
            <type>object</type>
            <type>audio</type>
            <type>video</type>
        </physicalElementTypes>
    </mets>
    <lido>
        <imageXPath>lido:resourceRepresentation[@lido:type='image_master']/lido:linkResource</imageXPath>
        <imageXPath>lido:resourceRepresentation[@lido:type='http://terminology.lido-schema.org/resourceRepresentation_type/provided_representation']/lido:linkResource</imageXPath>
        <imageXPath>lido:resourceRepresentation[@lido:type='http://terminology.lido-schema.org/lido00464']/lido:linkResource</imageXPath>
        <imageXPath>lido:resourceRepresentation[@lido:type='image_overview']/lido:linkResource</imageXPath>
        <imageXPath>lido:resourceID</imageXPath>
    </lido>
    <email>
        <recipients>admin@example.org</recipients>
        <smtpServer>localhost</smtpServer>
        <smtpUser></smtpUser>
        <smtpPassword></smtpPassword>
        <smtpSenderAddress>do-not-reply@goobi-viewer.example.org</smtpSenderAddress>
        <smtpSenderName>Goobi viewer Indexer</smtpSenderName>
        <smtpSecurity>NONE</smtpSecurity>
    </email>
    <viewerNotifications>
        <prerenderPdfs enabled="false" force="false" variant="small"/>
    </viewerNotifications>
</init>
```
{% endtab %}
{% endtabs %}

Die Parameter sind in der folgenden Tabelle im einzelnen erklärt:

| Option                                         | Bedeutung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ---------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **sleep**                                      | Wartezeit des Goobi viewer Indexers (in Millisekunden) zwischen Überwachungszyklen des Hotfolders. Standardwert ist `3000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **minStorageSpace**                            | <p>Minimum an freiem Festplattenspeicher (in MB) auf dem Laufwerk, auf dem sich der Hotfolder befindet, um indexieren zu können. </p><p>Sollte diese Größe unterschritten werden, beendet sich der Goobi viewer Indexer automatisch und muss (nach Vergrößerung des verfügbaren Speichers) manuell neu gestartet werden. Standardwert ist <code>2048</code>.</p>                                                                                                                                                                                                                                                                                                                                                                              |
| **solrUrl**                                    | URL des Apache Solr Servers, der den Index enthält. Sämtliche Kommunikation zwischen dem Goobi viewer Indexer und Solr erfolgt über HTTP Queries.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **oldSolrUrl**                                 | <p>Sofern bei einer kompletten Neuindexierung bestimmte Felder aus einem alten Solr Index in den neuen übernommen werden sollen, muss in diesem Element die URL zum alten Solr stehen. Die übernommenen Felder sind <code>DATECREATED</code>, <code>DATEUPDATED</code> und <code>THUMBNAILREPRESENT</code>. Bei Anchor Werken kommt noch die <code>IDDOC</code> hinzu. Liegen die Werke in einem <code>DATAREPOSITORY</code>, wird die Information über die Zugehörigkeit ebenfalls mit portiert.</p><p>Dieser Schalter wurde mit der Version 4.8.0 eingeführt um die Migration von Solr 4 zu Solr 8 zu ermöglichen. In einer regulären Installation wird dieses Element nicht benötigt.</p>                                                  |
| **viewerUrl**                                  | URL zum Goobi viewer damit zum Beispiel beim Neuindexieren eines Werkes automatisch alte Bilder aus dem Cache entfernt werden.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **viewerAuthorizationToken**                   | Damit beim Verschieben von Datensätzen zwischen DataRepositories der Goobi viewer über die Änderung informiert werden kann, wird ein Token benötigt. Der Token wird in der config\_viewer.xml hinterlegt. Sie dazu auch [Kapitel 1.33.3](../1/33/3.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **deleteContentFilesOnFailure**                | <p>Es kann vorkommen, dass die Indexierung eines Objektes etwa durch eine fehlerhafte XML Datei fehlschlägt.<br>In einem solchen Fall werden die Datei und alle dazugehörigen Ordner (Medien, Volltexte, Wordkoordinaten, etc.) aus dem Hotfolder entfernt. Je nach Objekt kann es aber vorkommen, dass die dazugehörigen Ordner große Datenmengen enthalten, so dass das Kopieren dieser Daten in den Hotfolder sehr viel Zeit in Anspruch nimmt. In solchen Fällen gibt es die Möglichkeit, diese Ordner auch bei Scheitern im Hotfolder zu belassen, damit diese mit einer korrigierten XML Datei verwendet werden können. Das Verbleiben dieser Ordner im Hotfolder hat keinen Einfluss auf die Indexierung etwaiger anderer Objekte.</p> |
| **addVolumeCollectionsToAnchor**               | Bei der Indexierung von mehrbändigen Werken kann es vorkommen, dass Bände unterschiedlichen Sammlungen angehören. Wenn dieses Element auf `true` steht, werden Sammlungsnamen aus allen im Index enthaltenen Bänden auch in das Gesamtwerk kopiert (Sammlungen, denen nur das Gesamtwerk angehört, bleiben ebenfalls erhalten). Zu beachten ist hier, dass evtl. Schreibfehler bei Sammlungsnamen nicht mehr automatisiert aus dem Gesamtwerk entfernt werden können, wenn diese Option aktiviert ist. Standardwert ist `false`.                                                                                                                                                                                                              |
| **representativeImage/useFirstPageAsDefault**  | <p>Bei <code>true</code> wird die erste Seite eines Dokuments als Repräsentant festgelegt, wenn keine andere Seite im Quelldokument angegeben ist. Ist dieser Wert auf <code>false</code> gesetzt und wird keine Seite explizit als repräsentativ festgelegt, wird kein Repräsentant festgelegt.</p><p>Standardwert ist <code>true</code>.</p>                                                                                                                                                                                                                                                                                                                                                                                                |
| **namespaces**                                 | <p>Werden in METS Dokumenten zusätzliche XML Namespaces eingebettet, müssen diese dem Goobi viewer Indexer mitgeteilt werden, damit entsprechende XPath Ausdrücke ausgewertet werden können. Der Namespace Name wird dabei als Elementname innerhalb des Elements  definiert, die Namespace URI als Textwert dieses Elements.</p><p>Sind keine zusätzlichen Namespaces definiert, darf kein leeres Element <code>&#x3C;list></code> vorhanden sein.</p>                                                                                                                                                                                                                                                                                       |
| **pageCountStart**                             | Der Goobi viewer erwartet eine Seitenzählung, die bei 1 anfängt. Um einer stetigen Abweichung in der Seitennavigation entgegenzuwirken, kann die Kompatibilität zu älteren Goobi viewer Versionen hergestellt werden, indem der Wert auf 0 gesetzt wird. Standardwert ist `1`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **addLabelToChildren**                         | Steht dieser Schalter auf true, werden die Werte der `LABEL`-Felder von Strukturelementen in das `DEFAULT`-Feld von untergeordnenten Strukturelementen geschrieben. Standardwert ist `false`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **labelCleanup**                               | Steht dieser Schalter auf true, werden Nichtsortierzeichen-Sequenzen "`<ns></ns>`", "`<<>>`" und "`¬`" aus dem Wert entfernt. Standardwert ist `false`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **authorityData/@enabled**                     | Wenn der Wert auf `false` steht, wird die Indexierung von Normdaten komplett deaktiviert. Standardwert ist `true`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **authorityData/addFieldsToDefault/field**     | Werte bestimmte Normdatenfelder (zum Beispiel alternative Schreibweisen eines Namen) können zum DEFAULT-Suchfeld hinzugefügt werden, um direkte Suchbarkeit zu gewährleisten. Hierzu wird für jedes gewünschte Feld ein neues Konfigurationselement hinzugefügt (zum Beispiel `<field>NORM_ALTNAME</field>`).                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **aggregateRecords**                           | Wenn auf true gesetzt, werden die für die aggregierte Suche notwendigen Zusatzfelder (etwa aggregierte Volltexte und Metadaten) in den Index geschrieben. Standardwert ist `false`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **fulltextForceUTF8**                          | Wenn auf `true` gesetzt, werden Volltexte automatisch nach UTF-8 konvertiert, wenn ein anderer Charset erkannt wird. Standardwert ist `true`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **mets/preferredImageFileGroup**               | Wenn hier Dateigruppen konfiguriert sind und eine Gruppe mit diesem Namen existiert, wird sie für die Indexierung von Bilddateipfaden verwendet.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **mets/physicalElementTypes/type**             | Neben `"page"` (immer erlaubt) können hier zusätzliche Werte für `mets:structMap[@TYPE="PHYSICAL"]/mets:div[@TYPE="physSequence"]/mets:div/@TYPE` definiert werden, die als Page-Dokumente verarbeitet werden sollen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **lido/imageXPath**                            | Um die Heterogenität Image-Pfade in LIDO-Dokumenten zu berücksichtigen, sind die möglichen XPath-Ausdrücke (relativ zu lido:resourceSet), in denen Bildverlinkungen gesucht werden, konfigurierbar. Die Liste wird von oben nach unten abgearbeitet, und der erste Ausdruck, der Treffer liefert, wird verwendet (die restlichen werden ignoriert).                                                                                                                                                                                                                                                                                                                                                                                           |
| **email/...**                                  | Sofern bei der Indexierung Fehler auftreten kann der Goobi viewer Indexer die im Element recipients definierten Emailadressen benachrichtigen. Die Konfiguration erfolgt analog zu der in [Kapitel 1.5.2](../1/5/2.md) beschriebenen Weise.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **viewerNotifications/prerenderPdfs/@enabled** | Sofern aktiv, wird der Goobi viewer bei der Indexierung eines Werkes zu dem im Hotfolder Bilder liegen angewiesen, PDF-Dateien vorzugenerieren. Standardwert ist `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **viewerNotifications/prerenderPdfs/@force**   | Sofern aktiv wird der Goobi viewer auch wenn keine Bilder im Hotfolder vorliegen angewiesen PDF-Dateien vorzugenerieren. Das kann zum Beispiel bei einer Neuindexierung für die einmalige Generierung der Dateien genutzt werden. Standardwert ist `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **viewerNotifications/prerenderPdfs/@variant** | Gibt die pdfConfig Variante aus der Konfigurationsdatei des Contentservers an, die für die Generierung der PDF-Dateien verwendet werden soll. Standardwert ist `small`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

